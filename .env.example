# =============================================================================
# MY-SAAS-CHAT - ROOT ENVIRONMENT VARIABLES
# Production Deployment Configuration
# =============================================================================
#
# IMPORTANT SECURITY NOTES:
# - DO NOT commit actual .env files to version control
# - Generate strong random values for all secrets
# - Use different values for development, staging, and production
# - Store production secrets in a secure vault (AWS Secrets Manager, HashiCorp Vault, etc.)
#
# Copy this file to .env and fill in your actual values
# =============================================================================

# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================
NODE_ENV=production  # Options: development, staging, production
DEPLOYMENT_ENV=production  # Deployment environment identifier
LOG_LEVEL=info  # Options: debug, info, warn, error

# =============================================================================
# APPLICATION SECRETS
# =============================================================================
# Generate with: openssl rand -hex 32
AUTH_SECRET=your-256-bit-secret-key-here-change-this-in-production
JWT_SECRET=your-jwt-secret-key-here-change-this-in-production
REFRESH_TOKEN_SECRET=your-refresh-token-secret-here-change-this

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL (Primary Database)
POSTGRES_USER=postgres
POSTGRES_PASSWORD=change-this-in-production
POSTGRES_DB=saas_db
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}?schema=public

# MongoDB (Analytics & Logs)
MONGO_INITDB_ROOT_USERNAME=mongo
MONGO_INITDB_ROOT_PASSWORD=change-this-in-production
MONGODB_HOST=mongodb
MONGODB_PORT=27017
MONGODB_URL=mongodb://${MONGO_INITDB_ROOT_USERNAME}:${MONGO_INITDB_ROOT_PASSWORD}@${MONGODB_HOST}:${MONGODB_PORT}/admin

# Redis (Cache & Sessions)
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# ClickHouse (Analytics)
CLICKHOUSE_HOST=clickhouse
CLICKHOUSE_PORT=8123
CLICKHOUSE_USER=analytics
CLICKHOUSE_PASSWORD=change-this-in-production
CLICKHOUSE_DB=analytics_db

# =============================================================================
# MESSAGE QUEUE
# =============================================================================
RABBITMQ_DEFAULT_USER=admin
RABBITMQ_DEFAULT_PASS=change-this-in-production
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_MANAGEMENT_PORT=15672
RABBITMQ_URL=amqp://${RABBITMQ_DEFAULT_USER}:${RABBITMQ_DEFAULT_PASS}@${RABBITMQ_HOST}:${RABBITMQ_PORT}
RABBITMQ_EXCHANGE=analytics.events
RABBITMQ_QUEUE=analytics_events_queue

# =============================================================================
# MICROSERVICES CONFIGURATION
# =============================================================================

# Auth Service
AUTH_SERVICE_PORT=3001
AUTH_SERVICE_URL=http://auth-service:3001

# Chat Service
CHAT_SERVICE_PORT=3002
CHAT_SERVICE_URL=http://chat-service:3002

# Billing Service
BILLING_SERVICE_PORT=3003
BILLING_SERVICE_URL=http://billing-service:3003

# Analytics Service
ANALYTICS_SERVICE_PORT=3004
ANALYTICS_SERVICE_URL=http://analytics-service:3004

# Orchestrator Service
ORCHESTRATOR_SERVICE_PORT=3006
ORCHESTRATOR_SERVICE_URL=http://orchestrator-service:3006

# API Gateway
API_GATEWAY_PORT=4000
API_GATEWAY_URL=http://api-gateway:4000

# =============================================================================
# EXTERNAL SERVICES - AI PROVIDERS
# =============================================================================

# OpenAI
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_ORG_ID=
OPENAI_MODEL=gpt-4
OPENAI_EMBEDDING_MODEL=text-embedding-3-small

# Anthropic (Claude)
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022

# Google AI
GOOGLE_API_KEY=your-google-ai-api-key-here
GOOGLE_MODEL=gemini-pro

# Groq
GROQ_API_KEY=your-groq-api-key-here
GROQ_MODEL=llama2-70b-4096

# Pinecone Vector Database
PINECONE_API_KEY=your-pinecone-api-key-here
PINECONE_ENVIRONMENT=us-west1-gcp
PINECONE_INDEX_NAME=prompt-upgrader

# =============================================================================
# EXTERNAL SERVICES - PAYMENTS
# =============================================================================

# Stripe
STRIPE_SECRET_KEY=sk_live_your-stripe-secret-key-here
STRIPE_PUBLISHABLE_KEY=pk_live_your-stripe-publishable-key-here
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret-here
STRIPE_PRICE_ID_FREE=price_free_tier_id
STRIPE_PRICE_ID_PRO=price_pro_tier_id
STRIPE_PRICE_ID_ENTERPRISE=price_enterprise_tier_id

# =============================================================================
# EXTERNAL SERVICES - EMAIL
# =============================================================================

# SMTP Configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-specific-password
SMTP_FROM=noreply@yourdomain.com
SMTP_FROM_NAME=My SaaS Chat

# Email Service Provider (Alternative to SMTP)
# SENDGRID_API_KEY=your-sendgrid-api-key
# MAILGUN_API_KEY=your-mailgun-api-key
# MAILGUN_DOMAIN=your-mailgun-domain

# =============================================================================
# FRONTEND CONFIGURATION
# =============================================================================
FRONTEND_URL=https://yourdomain.com
FRONTEND_PORT=3000
CORS_ORIGIN=https://yourdomain.com,https://www.yourdomain.com

# =============================================================================
# AUTHENTICATION & AUTHORIZATION
# =============================================================================
JWT_EXPIRY=15m  # Access token expiry
REFRESH_TOKEN_EXPIRY=7d  # Refresh token expiry
REQUIRE_EMAIL_VERIFICATION=true
PASSWORD_RESET_EXPIRY=1h
MAX_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_DURATION=30m

# OAuth Providers (Optional)
GOOGLE_CLIENT_ID=your-google-oauth-client-id
GOOGLE_CLIENT_SECRET=your-google-oauth-client-secret
GITHUB_CLIENT_ID=your-github-oauth-client-id
GITHUB_CLIENT_SECRET=your-github-oauth-client-secret

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================

# Sentry (Error Tracking)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# Jaeger (Distributed Tracing)
JAEGER_AGENT_HOST=jaeger
JAEGER_AGENT_PORT=6831
JAEGER_SAMPLER_TYPE=probabilistic
JAEGER_SAMPLER_PARAM=0.1

# Prometheus (Metrics)
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# =============================================================================
# RATE LIMITING & QUOTAS
# =============================================================================

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100  # Max requests per window

# Token Quotas (per tier)
FREE_MONTHLY_TOKEN_QUOTA=100000
PRO_MONTHLY_TOKEN_QUOTA=1000000
ENTERPRISE_MONTHLY_TOKEN_QUOTA=10000000

# API Quotas
FREE_MONTHLY_UPGRADE_QUOTA=1000
PRO_MONTHLY_UPGRADE_QUOTA=10000
ENTERPRISE_MONTHLY_UPGRADE_QUOTA=100000

FREE_MONTHLY_EMBEDDING_QUOTA=10000
PRO_MONTHLY_EMBEDDING_QUOTA=100000
ENTERPRISE_MONTHLY_EMBEDDING_QUOTA=1000000

# =============================================================================
# CACHING & PERFORMANCE
# =============================================================================
CACHE_TTL_DEFAULT=3600  # 1 hour in seconds
SUMMARY_CACHE_TTL=604800  # 7 days
EMBEDDING_CACHE_TTL=2592000  # 30 days
RAG_CACHE_TTL=3600  # 1 hour

# Context Limits
MAX_CONTEXT_MESSAGES=10  # Last N messages to include
MAX_RAG_RESULTS=5  # Top K results from vector search
MAX_SUMMARY_LENGTH=500  # Max characters for summary

# =============================================================================
# SECURITY HEADERS & CORS
# =============================================================================
HELMET_ENABLED=true
CORS_CREDENTIALS=true
CSP_ENABLED=true
HSTS_MAX_AGE=31536000  # 1 year in seconds

# =============================================================================
# FILE UPLOAD
# =============================================================================
MAX_FILE_SIZE=10485760  # 10MB in bytes
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,application/pdf,text/plain
UPLOAD_DIR=/app/uploads
AWS_S3_BUCKET=your-s3-bucket-name
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key

# =============================================================================
# BACKUP & DISASTER RECOVERY
# =============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM (cron format)
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=your-backup-bucket-name

# =============================================================================
# API GATEWAY - KONG CONFIGURATION
# =============================================================================
KONG_DATABASE=postgres
KONG_PG_HOST=kong-database
KONG_PG_USER=kong
KONG_PG_PASSWORD=change-this-in-production
KONG_PG_DATABASE=kong
KONG_ADMIN_LISTEN=0.0.0.0:8001
KONG_PROXY_ACCESS_LOG=/dev/stdout
KONG_ADMIN_ACCESS_LOG=/dev/stdout
KONG_PROXY_ERROR_LOG=/dev/stderr
KONG_ADMIN_ERROR_LOG=/dev/stderr

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_CHAT_ENABLED=true
FEATURE_SUMMARIZER_ENABLED=true
FEATURE_RAG_ENABLED=true
FEATURE_PROMPT_UPGRADER_ENABLED=true
FEATURE_PII_DETECTION_ENABLED=true
FEATURE_ANALYTICS_ENABLED=true
FEATURE_BILLING_ENABLED=true

# =============================================================================
# MAINTENANCE MODE
# =============================================================================
MAINTENANCE_MODE=false
MAINTENANCE_MESSAGE=We are currently performing maintenance. Please try again later.
MAINTENANCE_ALLOWED_IPS=127.0.0.1,::1

# =============================================================================
# DOCKER COMPOSE OVERRIDES
# =============================================================================
COMPOSE_PROJECT_NAME=my-saas-chat
COMPOSE_FILE=docker-compose.prod.yml

# =============================================================================
# HEALTH CHECKS
# =============================================================================
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=3s
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=40s

# =============================================================================
# RESOURCE LIMITS (Docker)
# =============================================================================
AUTH_SERVICE_CPU_LIMIT=1
AUTH_SERVICE_MEMORY_LIMIT=512M
CHAT_SERVICE_CPU_LIMIT=1.5
CHAT_SERVICE_MEMORY_LIMIT=768M
BILLING_SERVICE_CPU_LIMIT=1
BILLING_SERVICE_MEMORY_LIMIT=512M
ORCHESTRATOR_SERVICE_CPU_LIMIT=2
ORCHESTRATOR_SERVICE_MEMORY_LIMIT=1024M
ANALYTICS_SERVICE_CPU_LIMIT=1.5
ANALYTICS_SERVICE_MEMORY_LIMIT=768M

# =============================================================================
# NOTES
# =============================================================================
#
# Service-specific overrides can be placed in:
# - backend/services/auth-service/.env.production
# - backend/services/chat-service/.env.production
# - backend/services/billing-service/.env.production
# - backend/services/analytics-service/.env.production
# - backend/services/orchestrator-service/.env.production
# - backend/services/email-worker/.env.production
#
# These service-specific files will inherit from this root .env file
# and can override specific variables as needed.
#
# =============================================================================
