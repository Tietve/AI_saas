# =============================================================================
# BILLING SERVICE - Environment Variables
# Port: 3003
# =============================================================================
#
# Copy this file to .env and fill in your values
# Most variables can be inherited from root .env file
#
# =============================================================================

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
PORT=3003
NODE_ENV=development
LOG_LEVEL=info

# =============================================================================
# DATABASE - PostgreSQL
# =============================================================================
# PostgreSQL connection URL (REQUIRED)
DATABASE_URL=postgresql://postgres:password@localhost:5432/saas_billing_db

# Connection Pool Settings (optional)
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_TIMEOUT=30000

# =============================================================================
# STRIPE PAYMENT GATEWAY
# =============================================================================
# Stripe API Keys (REQUIRED)
# Get from: https://dashboard.stripe.com/apikeys

# Secret key (REQUIRED - use test key for development)
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key-here

# Publishable key (REQUIRED)
STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key-here

# Webhook secret (REQUIRED for webhook verification)
# Get from: https://dashboard.stripe.com/webhooks
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret-here

# Price IDs for subscription tiers (optional)
STRIPE_PRICE_ID_FREE=price_free_tier_id
STRIPE_PRICE_ID_PRO=price_pro_tier_id
STRIPE_PRICE_ID_ENTERPRISE=price_enterprise_tier_id

# =============================================================================
# AUTHENTICATION
# =============================================================================
# For JWT verification (must match auth-service)
AUTH_SECRET=your-256-bit-secret-key-here-change-this-in-production

# =============================================================================
# MESSAGE QUEUE - RabbitMQ
# =============================================================================
# For publishing billing events (REQUIRED)
RABBITMQ_URL=amqp://admin:admin@localhost:5672
RABBITMQ_EXCHANGE=analytics.events

# =============================================================================
# SUBSCRIPTION & QUOTA LIMITS
# =============================================================================

# Token Quotas
FREE_MONTHLY_TOKEN_QUOTA=100000
PRO_MONTHLY_TOKEN_QUOTA=1000000
ENTERPRISE_MONTHLY_TOKEN_QUOTA=10000000

# API Usage Quotas
FREE_MONTHLY_UPGRADE_QUOTA=1000
PRO_MONTHLY_UPGRADE_QUOTA=10000
ENTERPRISE_MONTHLY_UPGRADE_QUOTA=100000

FREE_MONTHLY_EMBEDDING_QUOTA=10000
PRO_MONTHLY_EMBEDDING_QUOTA=100000
ENTERPRISE_MONTHLY_EMBEDDING_QUOTA=1000000

# =============================================================================
# FRONTEND & CORS
# =============================================================================
FRONTEND_URL=http://localhost:3000
CORS_ORIGIN=http://localhost:3000
CORS_CREDENTIALS=true

# =============================================================================
# MONITORING & OBSERVABILITY (Optional)
# =============================================================================

# Sentry Error Tracking
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1
SENTRY_DEBUG=false

# Jaeger Distributed Tracing
JAEGER_AGENT_HOST=localhost
JAEGER_AGENT_PORT=6831
JAEGER_SAMPLER_TYPE=probabilistic
JAEGER_SAMPLER_PARAM=0.1
JAEGER_SERVICE_NAME=billing-service

# Prometheus Metrics
PROMETHEUS_ENABLED=false
PROMETHEUS_PORT=9090

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_BILLING_ENABLED=true

# =============================================================================
# NOTES
# =============================================================================
# - This service handles: Stripe subscriptions, webhooks, quota management
# - Required: DATABASE_URL, STRIPE_SECRET_KEY, STRIPE_WEBHOOK_SECRET
# - Stripe test keys start with sk_test_ and pk_test_
# - Stripe live keys start with sk_live_ and pk_live_
# - Test webhook secret with Stripe CLI: stripe listen --forward-to localhost:3003/api/billing/webhook
# - See docs/CONFIGURATION.md for complete reference
