# =============================================================================
# ANALYTICS SERVICE - PRODUCTION ENVIRONMENT
# =============================================================================
# This file contains service-specific overrides for production
# Inherits from root .env file
# =============================================================================

# Service Configuration
NODE_ENV=production
PORT=3004
SERVICE_NAME=analytics-service

# ClickHouse Configuration
CLICKHOUSE_HOST=clickhouse
CLICKHOUSE_PORT=8123
CLICKHOUSE_USER=analytics
CLICKHOUSE_PASSWORD=${CLICKHOUSE_PASSWORD}
CLICKHOUSE_DB=analytics_db
CLICKHOUSE_MAX_RETRIES=3
CLICKHOUSE_REQUEST_TIMEOUT=30000

# RabbitMQ Configuration
RABBITMQ_URL=amqp://${RABBITMQ_DEFAULT_USER}:${RABBITMQ_DEFAULT_PASS}@rabbitmq:5672
RABBITMQ_EXCHANGE=analytics.events
RABBITMQ_QUEUE=analytics_events_queue
RABBITMQ_DEAD_LETTER_EXCHANGE=analytics.dlx
RABBITMQ_DEAD_LETTER_QUEUE=analytics_dlq
RABBITMQ_PREFETCH_COUNT=10

# Redis (For caching)
REDIS_URL=redis://redis:6379/3
REDIS_PASSWORD=
REDIS_DB=3

# Auth Configuration
AUTH_SECRET=${AUTH_SECRET}
AUTH_SERVICE_URL=http://auth-service:3001

# Analytics Configuration
BATCH_SIZE=1000
BATCH_INTERVAL_MS=5000
RETENTION_DAYS=90
AGGREGATION_INTERVAL=300000  # 5 minutes

# Event Types
TRACK_USER_EVENTS=true
TRACK_CHAT_EVENTS=true
TRACK_BILLING_EVENTS=true
TRACK_API_EVENTS=true
TRACK_ERROR_EVENTS=true

# Monitoring
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9091
SENTRY_DSN=${SENTRY_DSN}
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Distributed Tracing
JAEGER_AGENT_HOST=jaeger
JAEGER_AGENT_PORT=6831
JAEGER_SERVICE_NAME=analytics-service

# Logging
LOG_LEVEL=info

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=1000

# Health Check
HEALTH_CHECK_ENABLED=true

# Data Retention
AUTO_CLEANUP_ENABLED=true
CLEANUP_SCHEDULE=0 3 * * *  # Daily at 3 AM
