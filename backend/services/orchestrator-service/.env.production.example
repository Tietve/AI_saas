# =============================================================================
# ORCHESTRATOR SERVICE - PRODUCTION ENVIRONMENT
# =============================================================================
# This file contains service-specific overrides for production
# Inherits from root .env file
# =============================================================================

# Service Configuration
NODE_ENV=production
PORT=3006
SERVICE_NAME=orchestrator-service

# Database (Uses shared PostgreSQL)
DATABASE_URL=postgresql://postgres:${POSTGRES_PASSWORD}@postgres:5432/my_saas_chat_orchestrator?schema=public

# Redis (Uses shared Redis)
REDIS_URL=redis://redis:6379/4
REDIS_PASSWORD=
REDIS_DB=4

# Auth Configuration
AUTH_SECRET=${AUTH_SECRET}
AUTH_SERVICE_URL=http://auth-service:3001

# pgvector (PostgreSQL Vector Extension)
# Note: pgvector is now used instead of Pinecone for cost optimization ($70/mo -> $0)
# pgvector is enabled via PostgreSQL extension (configured in Prisma schema)
# No additional configuration needed - vectors are stored in PostgreSQL

# OpenAI Configuration
OPENAI_API_KEY=${OPENAI_API_KEY}
OPENAI_ORG_ID=${OPENAI_ORG_ID}

# AI Model Configuration
EMBEDDING_MODEL=text-embedding-3-small
SUMMARIZER_MODEL=gpt-4o-mini
UPGRADER_MODEL=gpt-4o-mini
MAIN_LLM_MODEL=gpt-4

# Cache TTL (in seconds)
SUMMARY_CACHE_TTL=604800  # 7 days
EMBEDDING_CACHE_TTL=2592000  # 30 days
RAG_CACHE_TTL=3600  # 1 hour

# Performance
MAX_CONTEXT_MESSAGES=10
MAX_RAG_RESULTS=5
MAX_SUMMARY_LENGTH=500

# Quotas (per tier)
FREE_MONTHLY_TOKEN_QUOTA=100000
PRO_MONTHLY_TOKEN_QUOTA=1000000
ENTERPRISE_MONTHLY_TOKEN_QUOTA=10000000

FREE_MONTHLY_UPGRADE_QUOTA=1000
PRO_MONTHLY_UPGRADE_QUOTA=10000
ENTERPRISE_MONTHLY_UPGRADE_QUOTA=100000

FREE_MONTHLY_EMBEDDING_QUOTA=10000
PRO_MONTHLY_EMBEDDING_QUOTA=100000
ENTERPRISE_MONTHLY_EMBEDDING_QUOTA=1000000

# Billing Integration
BILLING_SERVICE_URL=http://billing-service:3003
TRACK_USAGE=true

# Monitoring
SENTRY_DSN=${SENTRY_DSN}
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Distributed Tracing
JAEGER_AGENT_HOST=jaeger
JAEGER_AGENT_PORT=6831
JAEGER_SERVICE_NAME=orchestrator-service

# Logging
LOG_LEVEL=info

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Health Check
HEALTH_CHECK_ENABLED=true

# Feature Flags
FEATURE_PII_DETECTION=true
FEATURE_SUMMARIZER=true
FEATURE_RAG=true
FEATURE_PROMPT_UPGRADER=true

# PII Detection
PII_DETECTION_CONFIDENCE_THRESHOLD=0.85
PII_REDACTION_ENABLED=true

# RAG Configuration
RAG_MIN_SIMILARITY_SCORE=0.7
RAG_MAX_CHUNKS=5
RAG_CHUNK_SIZE=1000
RAG_CHUNK_OVERLAP=200
