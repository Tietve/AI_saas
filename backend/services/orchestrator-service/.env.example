# =============================================================================
# ORCHESTRATOR SERVICE - Environment Variables
# Port: 3006
# =============================================================================
#
# Copy this file to .env and fill in your values
# Most variables can be inherited from root .env file
#
# =============================================================================

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
PORT=3006
NODE_ENV=development
LOG_LEVEL=info

# =============================================================================
# DATABASE - PostgreSQL with pgvector
# =============================================================================
# PostgreSQL connection URL (REQUIRED)
# Note: This database includes pgvector extension for vector embeddings
DATABASE_URL=postgresql://user:password@localhost:5432/my_saas_chat_orchestrator?schema=public

# Connection Pool Settings (optional)
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_TIMEOUT=30000

# =============================================================================
# VECTOR DATABASE - pgvector (PostgreSQL Extension)
# =============================================================================
# pgvector is now used instead of Pinecone for cost optimization ($70/mo -> $0)
# pgvector is enabled via PostgreSQL extension (configured in Prisma schema)
# No additional configuration needed - vectors are stored in PostgreSQL
# IMPORTANT: Ensure PostgreSQL has pgvector extension installed:
#   CREATE EXTENSION IF NOT EXISTS vector;

# =============================================================================
# CACHE - Redis
# =============================================================================
# Redis connection URL (REQUIRED for caching)
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_KEY_PREFIX=orchestrator:
REDIS_CONNECT_TIMEOUT=10000
REDIS_COMMAND_TIMEOUT=5000

# =============================================================================
# AI PROVIDERS
# =============================================================================

# OpenAI (REQUIRED)
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_ORG_ID=
OPENAI_MODEL=gpt-4
OPENAI_EMBEDDING_MODEL=text-embedding-3-small
OPENAI_MAX_TOKENS=4096
OPENAI_TEMPERATURE=0.7
OPENAI_TIMEOUT=60000

# Anthropic Claude (Optional)
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022

# Google AI (Optional)
GOOGLE_AI_API_KEY=your-google-ai-api-key-here
GOOGLE_AI_MODEL=gemini-pro

# Cloudflare Workers AI (Optional - cost-optimized)
CLOUDFLARE_ACCOUNT_ID=your-cloudflare-account-id
CLOUDFLARE_API_TOKEN=your-cloudflare-api-token
CLOUDFLARE_AI_MODEL=@cf/meta/llama-2-7b-chat-int8

# =============================================================================
# CACHING & PERFORMANCE
# =============================================================================

# Cache TTL (in seconds)
CACHE_TTL_DEFAULT=3600
SUMMARY_CACHE_TTL=604800      # 7 days
EMBEDDING_CACHE_TTL=2592000   # 30 days
RAG_CACHE_TTL=3600            # 1 hour

# Performance Limits
MAX_CONTEXT_MESSAGES=10       # Last N messages to include in context
MAX_RAG_RESULTS=5             # Top K results from vector search
MAX_SUMMARY_LENGTH=500        # Max characters for summary

# =============================================================================
# RATE LIMITING & QUOTAS
# =============================================================================

# Token Quotas
FREE_MONTHLY_TOKEN_QUOTA=100000
PRO_MONTHLY_TOKEN_QUOTA=1000000
ENTERPRISE_MONTHLY_TOKEN_QUOTA=10000000

# API Usage Quotas
FREE_MONTHLY_UPGRADE_QUOTA=1000
PRO_MONTHLY_UPGRADE_QUOTA=10000
ENTERPRISE_MONTHLY_UPGRADE_QUOTA=100000

FREE_MONTHLY_EMBEDDING_QUOTA=10000
PRO_MONTHLY_EMBEDDING_QUOTA=100000
ENTERPRISE_MONTHLY_EMBEDDING_QUOTA=1000000

# =============================================================================
# MONITORING & OBSERVABILITY (Optional)
# =============================================================================

# Sentry Error Tracking
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1
SENTRY_DEBUG=false

# Jaeger Distributed Tracing
JAEGER_AGENT_HOST=localhost
JAEGER_AGENT_PORT=6831
JAEGER_SAMPLER_TYPE=probabilistic
JAEGER_SAMPLER_PARAM=0.1
JAEGER_SERVICE_NAME=orchestrator-service

# Prometheus Metrics
PROMETHEUS_ENABLED=false
PROMETHEUS_PORT=9090

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_SUMMARIZER_ENABLED=true
FEATURE_RAG_ENABLED=true
FEATURE_PROMPT_UPGRADER_ENABLED=true
FEATURE_PII_DETECTION_ENABLED=true

# =============================================================================
# NOTES
# =============================================================================
# - This service handles: Prompt upgrading, RAG, summarization, embeddings
# - Required: DATABASE_URL (with pgvector), REDIS_URL, OPENAI_API_KEY
# - Uses pgvector (PostgreSQL extension) for semantic search and prompt improvement
# - Uses Redis for caching embeddings and summaries
# - Cost optimized: pgvector instead of Pinecone saves ~$70/month
# - See docs/CONFIGURATION.md for complete reference
