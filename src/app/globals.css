/* src/app/globals.css */
@import '../styles/animations.css';
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
    :root {
        --radius: 0.625rem;

        /* Keep existing Tailwind variables */
        --background: 255 255 255;
        --foreground: 0 0 0;

        /* Color variables - using RGB values for Tailwind compatibility */
        --primary: 37 99 235;
        --primary-foreground: 248 250 252;
        --secondary: 240 240 240;
        --secondary-foreground: 24 24 24;
        --muted: 245 245 245;
        --muted-foreground: 115 115 115;
        --accent: 240 240 240;
        --accent-foreground: 24 24 24;
        --destructive: 239 68 68;
        --border: 229 229 229;
        --input: 229 229 229;
        --ring: 37 99 235;

        /* Theme System Colors (will be overridden by JS) */
        --color-primary: #D4AF37;
        --color-primary-hover: #F4CF57;
        --color-background: #0A0E1A;
        --color-background-secondary: #151B2C;
        --color-surface: #2A3655;
        --color-text: #F8F9FA;
        --color-text-secondary: #B8C1D1;
        --color-accent: #8B7355;
        --color-border: #2A3655;
        --color-success: #4ADE80;
        --color-error: #F87171;
        --color-warning: #FBBF24;
    }

    .dark {
        --background: 0 0 0;
        --foreground: 248 250 252;
        --primary: 96 165 250;
        --primary-foreground: 248 250 252;
        --secondary: 38 38 38;
        --secondary-foreground: 248 250 252;
        --muted: 38 38 38;
        --muted-foreground: 163 163 163;
        --accent: 38 38 38;
        --accent-foreground: 248 250 252;
        --destructive: 248 113 113;
        --border: 38 38 38;
        --input: 38 38 38;
        --ring: 96 165 250;
    }

    * {
        @apply border-border;
    }

    body {
        @apply bg-white text-gray-900 dark:bg-gray-900 dark:text-gray-100;
        font-family: system-ui, -apple-system, sans-serif;
    }
}

/* Theme Override System - Override Tailwind khi theme active */
.theme-override {
    /* Reset transitions */
    * {
        transition: background-color 0.3s ease,
        color 0.3s ease,
        border-color 0.3s ease !important;
    }
}

/* Override body khi theme active */
.theme-override body,
html.theme-override body {
    background-color: var(--color-background) !important;
    color: var(--color-text) !important;
}

/* Override ALL Tailwind background classes */
.theme-override .bg-white,
.theme-override .bg-gray-50,
.theme-override .bg-gray-100,
.theme-override .bg-slate-50 {
    background-color: var(--color-surface) !important;
}

.theme-override .bg-gray-200,
.theme-override .bg-gray-300 {
    background-color: var(--color-background-secondary) !important;
}

.theme-override .dark\:bg-gray-900,
.theme-override .dark\:bg-gray-800,
.theme-override .dark\:bg-slate-900 {
    background-color: var(--color-background-secondary) !important;
}

.theme-override .dark\:bg-gray-700 {
    background-color: var(--color-surface) !important;
}

/* Override ALL Tailwind text colors */
.theme-override .text-gray-900,
.theme-override .text-gray-800,
.theme-override .text-black,
.theme-override .text-slate-900 {
    color: var(--color-text) !important;
}

.theme-override .dark\:text-gray-100,
.theme-override .dark\:text-gray-50,
.theme-override .dark\:text-white {
    color: var(--color-text) !important;
}

.theme-override .text-gray-600,
.theme-override .text-gray-500,
.theme-override .text-slate-600 {
    color: var(--color-text-secondary) !important;
}

.theme-override .dark\:text-gray-400,
.theme-override .dark\:text-gray-300 {
    color: var(--color-text-secondary) !important;
}

/* Override ALL Tailwind border colors */
.theme-override .border-gray-200,
.theme-override .border-gray-300,
.theme-override .border-slate-200 {
    border-color: var(--color-border) !important;
}

.theme-override .dark\:border-gray-700,
.theme-override .dark\:border-gray-600 {
    border-color: var(--color-border) !important;
}

/* Override hover states */
.theme-override .hover\:bg-gray-50:hover,
.theme-override .hover\:bg-gray-100:hover {
    background-color: var(--color-surface) !important;
}

.theme-override .dark\:hover\:bg-gray-800:hover,
.theme-override .dark\:hover\:bg-gray-700:hover {
    background-color: var(--color-surface) !important;
}

/* Override focus states */
.theme-override .focus\:border-blue-500:focus,
.theme-override .focus\:ring-blue-500:focus {
    border-color: var(--color-primary) !important;
    --tw-ring-color: var(--color-primary) !important;
}

/* Override buttons */
.theme-override button:not(.no-theme-override),
.theme-override .btn-primary {
    background-color: var(--color-primary) !important;
    color: var(--color-background) !important;
    border-color: var(--color-primary) !important;
}

.theme-override button:not(.no-theme-override):hover,
.theme-override .btn-primary:hover {
    background-color: var(--color-primary-hover) !important;
}

.theme-override button:disabled {
    opacity: 0.5 !important;
    cursor: not-allowed !important;
}

/* Override inputs and textareas */
.theme-override input:not([type="checkbox"]):not([type="radio"]),
.theme-override textarea,
.theme-override select {
    background-color: var(--color-surface) !important;
    color: var(--color-text) !important;
    border-color: var(--color-border) !important;
}

.theme-override input:not([type="checkbox"]):not([type="radio"]):focus,
.theme-override textarea:focus,
.theme-override select:focus {
    border-color: var(--color-primary) !important;
    outline: none !important;
    box-shadow: 0 0 0 3px var(--color-primary) !important;
    box-shadow: 0 0 0 3px rgb(from var(--color-primary) r g b / 0.1) !important;
}

/* Components layer with theme support */
@layer components {
    /* Theme Selector Styles */
    .theme-selector {
        @apply relative;
    }

    .theme-trigger {
        @apply flex items-center gap-2 px-4 py-2 text-sm rounded-lg cursor-pointer transition-all;
        background: var(--color-surface);
        color: var(--color-text);
        border: 1px solid var(--color-border);
    }

    .theme-trigger:hover {
        background: var(--color-background-secondary);
        border-color: var(--color-primary);
    }

    .theme-dropdown {
        @apply absolute top-full right-0 mt-2 p-2 min-w-[200px] rounded-lg shadow-xl z-50;
        background: var(--color-surface);
        border: 1px solid var(--color-border);
        opacity: 0;
        visibility: hidden;
        transform: translateY(-10px);
        transition: all 0.2s;
    }

    .theme-dropdown.active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
    }

    .theme-option {
        @apply flex items-center gap-3 w-full p-2 rounded-md cursor-pointer transition-all text-left;
        background: transparent;
        color: var(--color-text);
        border: none;
    }

    .theme-option:hover {
        background: var(--color-background-secondary);
    }

    .theme-option.active {
        background: var(--color-primary);
        color: var(--color-background);
    }

    .theme-preview {
        @apply flex gap-1;
    }

    .color-dot {
        @apply w-4 h-4 rounded-full border border-white/20;
    }

    .theme-name {
        @apply flex-1 text-sm;
    }
}

/* Chat-specific component overrides */
.theme-override .chat-container {
    background: var(--color-background) !important;
    color: var(--color-text) !important;
}

.theme-override .chat-main-area {
    background: var(--color-background) !important;
}

.theme-override .chat-mobile-overlay {
    background: rgba(0, 0, 0, 0.5) !important;
}

.theme-override .chat-error-message {
    background: var(--color-error) !important;
    background-opacity: 0.1;
    border-color: var(--color-error) !important;
    color: var(--color-error) !important;
}

.theme-override .chat-error-close {
    color: var(--color-error) !important;
}

.theme-override .chat-sidebar {
    background: var(--color-background-secondary) !important;
    border-right: 1px solid var(--color-border) !important;
}

.theme-override .chat-sidebar-header {
    background: var(--color-background-secondary) !important;
    border-bottom: 1px solid var(--color-border) !important;
}

.theme-override .chat-sidebar-footer {
    background: var(--color-background-secondary) !important;
    border-top: 1px solid var(--color-border) !important;
}

.theme-override .chat-new-button {
    background: var(--color-primary) !important;
    background-image: linear-gradient(to right, var(--color-primary), var(--color-primary-hover)) !important;
    color: var(--color-background) !important;
}

.theme-override .chat-new-button:hover {
    background-image: linear-gradient(to right, var(--color-primary-hover), var(--color-accent)) !important;
}

.theme-override .chat-signout-button {
    background: var(--color-surface) !important;
    color: var(--color-text) !important;
}

.theme-override .chat-signout-button:hover {
    background: var(--color-accent) !important;
    opacity: 0.8;
}

.theme-override .chat-header {
    background: var(--color-surface) !important;
    border-bottom: 1px solid var(--color-border) !important;
}

.theme-override .chat-messages-area {
    background: var(--color-background) !important;
    background-image: linear-gradient(to bottom,
    var(--color-background),
    var(--color-background-secondary)) !important;
}

.theme-override .chat-messages-container {
    /* Container for proper spacing */
}

.theme-override .conversation-item {
    background: transparent !important;
    color: var(--color-text-secondary) !important;
    border-left: 4px solid transparent !important;
}

.theme-override .conversation-item:hover {
    background: var(--color-surface) !important;
    color: var(--color-text) !important;
}

.theme-override .conversation-item.active {
    background: var(--color-surface) !important;
    border-left-color: var(--color-primary) !important;
}

.theme-override .conversation-item.active .conversation-item-title {
    color: var(--color-primary) !important;
}

.theme-override .conversation-item-title {
    color: var(--color-text) !important;
}

.theme-override .conversation-item-meta {
    color: var(--color-text-secondary) !important;
}

.theme-override .conversation-item-delete {
    background: transparent !important;
}

.theme-override .conversation-item-delete:hover {
    background: var(--color-error) !important;
    opacity: 0.2;
}

.theme-override .chat-message {
    background: transparent !important;
    color: var(--color-text) !important;
}

.theme-override .chat-message:hover {
    background: var(--color-surface) !important;
    background-opacity: 0.5;
}

.theme-override .chat-message.user {
    background: var(--color-surface) !important;
    background-opacity: 0.3;
}

.theme-override .chat-message.user:hover {
    background: var(--color-surface) !important;
    background-opacity: 0.5;
}

.theme-override .chat-message-author {
    color: var(--color-text) !important;
}

.theme-override .chat-message-time {
    color: var(--color-text-secondary) !important;
}

.theme-override .chat-message-model {
    background: var(--color-surface) !important;
    color: var(--color-text-secondary) !important;
}

.theme-override .chat-message-text {
    color: var(--color-text) !important;
}

.theme-override .user-avatar {
    background: var(--color-primary) !important;
    background-image: linear-gradient(135deg, var(--color-primary), var(--color-accent)) !important;
    color: var(--color-background) !important;
}

.theme-override .chat-input-container {
    background: var(--color-background) !important;
    border-top: 1px solid var(--color-border) !important;
}

.theme-override .chat-input {
    background: var(--color-surface) !important;
    color: var(--color-text) !important;
    border: 1px solid var(--color-border) !important;
}

.theme-override .chat-input:focus {
    border-color: var(--color-primary) !important;
    box-shadow: 0 0 0 3px rgb(from var(--color-primary) r g b / 0.1) !important;
}

.theme-override .chat-input::placeholder {
    color: var(--color-text-secondary) !important;
}

.theme-override .chat-kbd {
    background: var(--color-surface) !important;
    color: var(--color-text-secondary) !important;
    border: 1px solid var(--color-border) !important;
}

/* Animation utilities */
@layer utilities {
    .animate-in {
        animation: animateIn 0.3s ease-in-out;
    }

    .animate-out {
        animation: animateOut 0.3s ease-in-out;
    }

    @keyframes animateIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes animateOut {
        from {
            opacity: 1;
            transform: translateY(0);
        }
        to {
            opacity: 0;
            transform: translateY(10px);
        }
    }
}

/* Scrollbar styling with theme support */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    @apply bg-gray-100 dark:bg-gray-800;
}

.theme-override ::-webkit-scrollbar-track {
    background: var(--color-background-secondary) !important;
}

::-webkit-scrollbar-thumb {
    @apply bg-gray-400 dark:bg-gray-600 rounded-md;
}

.theme-override ::-webkit-scrollbar-thumb {
    background: var(--color-surface) !important;
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    @apply bg-gray-500 dark:bg-gray-500;
}

.theme-override ::-webkit-scrollbar-thumb:hover {
    background: var(--color-accent) !important;
}

/* For Firefox */
* {
    scrollbar-width: thin;
    scrollbar-color: theme('colors.gray.400') theme('colors.gray.100');
}

.dark * {
    scrollbar-color: theme('colors.gray.600') theme('colors.gray.800');
}

.theme-override * {
    scrollbar-color: var(--color-surface) var(--color-background-secondary) !important;
}

/* Utility class để exclude element khỏi theme override */
.no-theme-override {
    all: revert !important;
}